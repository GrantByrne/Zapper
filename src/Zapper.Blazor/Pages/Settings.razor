@page "/settings"

<PageTitle>Zapper - Settings</PageTitle>

<MudText Typo="Typo.h3" GutterBottom="true">Settings</MudText>
<MudText Class="mb-4">Configure your Zapper preferences</MudText>

<MudGrid>
    <MudItem xs="12" md="6">
        <MudCard Class="mb-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">General Settings</MudText>
                </CardHeaderContent>
                <CardHeaderActions>
                    <MudIcon Icon="@Icons.Material.Filled.Settings" />
                </CardHeaderActions>
            </MudCardHeader>
            <MudCardContent>
                <MudSwitch @bind-Value="_enableNotifications" Color="Color.Primary" Label="Enable Notifications" Class="mb-3" />
                <MudSwitch @bind-Value="_enableHapticFeedback" Color="Color.Primary" Label="Enable Haptic Feedback" Class="mb-3" />
                <MudSwitch @bind-Value="_enableAutoDiscovery" Color="Color.Primary" Label="Auto Device Discovery" Class="mb-3" />
                <MudSelect @bind-Value="_defaultActivity" Label="Default Activity" Class="mb-3">
                    <MudSelectItem Value="@("watch-tv")">Watch TV</MudSelectItem>
                    <MudSelectItem Value="@("movie-night")">Movie Night</MudSelectItem>
                    <MudSelectItem Value="@("gaming")">Gaming</MudSelectItem>
                    <MudSelectItem Value="@("music")">Music</MudSelectItem>
                </MudSelect>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" md="6">
        <MudCard Class="mb-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">Device Settings</MudText>
                </CardHeaderContent>
                <CardHeaderActions>
                    <MudIcon Icon="@Icons.Material.Filled.Devices" />
                </CardHeaderActions>
            </MudCardHeader>
            <MudCardContent>
                <MudNumericField @bind-Value="_deviceTimeout" Label="Device Timeout (seconds)" Min="5" Max="60" Class="mb-3" />
                <MudNumericField @bind-Value="_retryAttempts" Label="Connection Retry Attempts" Min="1" Max="10" Class="mb-3" />
                <MudSlider @bind-Value="_irPowerLevel" Min="1" Max="10" Step="1" TickMarks="true" Color="Color.Primary" Class="mb-3">
                    IR Power Level: @_irPowerLevel
                </MudSlider>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" md="6">
        <MudCard Class="mb-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">Network Settings</MudText>
                </CardHeaderContent>
                <CardHeaderActions>
                    <MudIcon Icon="@Icons.Material.Filled.Wifi" />
                </CardHeaderActions>
            </MudCardHeader>
            <MudCardContent>
                <MudNumericField @bind-Value="_discoveryPort" Label="Discovery Port" Class="mb-3" />
                <MudNumericField @bind-Value="_apiTimeout" Label="API Timeout (ms)" Class="mb-3" />
                <MudSwitch @bind-Value="_enableSsdp" Color="Color.Primary" Label="Enable SSDP Discovery" Class="mb-3" />
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" md="6">
        <MudCard Class="mb-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">Advanced Settings</MudText>
                </CardHeaderContent>
                <CardHeaderActions>
                    <MudIcon Icon="@Icons.Material.Filled.Tune" />
                </CardHeaderActions>
            </MudCardHeader>
            <MudCardContent>
                <MudSwitch @bind-Value="_enableDebugLogging" Color="Color.Primary" Label="Enable Debug Logging" Class="mb-3" />
                <MudSwitch @bind-Value="_enableTelemetry" Color="Color.Primary" Label="Enable Telemetry" Class="mb-3" />
                <MudButton Variant="Variant.Outlined" StartIcon="@Icons.Material.Filled.Backup" Class="mb-2 mr-2">
                    Export Settings
                </MudButton>
                <MudButton Variant="Variant.Outlined" StartIcon="@Icons.Material.Filled.Restore" Class="mb-2">
                    Import Settings
                </MudButton>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12">
        <MudCard>
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">About</MudText>
                </CardHeaderContent>
                <CardHeaderActions>
                    <MudIcon Icon="@Icons.Material.Filled.Info" />
                </CardHeaderActions>
            </MudCardHeader>
            <MudCardContent>
                <MudText Class="mb-2"><strong>Version:</strong> 1.0.0</MudText>
                <MudText Class="mb-2"><strong>Build:</strong> @DateTime.Now.ToString("yyyy.MM.dd")</MudText>
                <MudText Class="mb-2"><strong>Platform:</strong> Raspberry Pi / ASP.NET Core</MudText>
                <MudDivider Class="my-3" />
                <MudButton Variant="Variant.Text" StartIcon="@Icons.Material.Filled.Code" Href="https://github.com/yourusername/zapper" Target="_blank">
                    View on GitHub
                </MudButton>
            </MudCardContent>
        </MudCard>
    </MudItem>
</MudGrid>

<MudFab Color="Color.Primary" StartIcon="@Icons.Material.Filled.Save" Label="Save Settings" Class="mt-4" OnClick="SaveSettings" />

@code {
    private bool _enableNotifications = true;
    private bool _enableHapticFeedback = true;
    private bool _enableAutoDiscovery = true;
    private string _defaultActivity = "watch-tv";
    private int _deviceTimeout = 30;
    private int _retryAttempts = 3;
    private int _irPowerLevel = 5;
    private int _discoveryPort = 1900;
    private int _apiTimeout = 5000;
    private bool _enableSsdp = true;
    private bool _enableDebugLogging = false;
    private bool _enableTelemetry = true;

    private async Task SaveSettings()
    {
        // TODO: Implement settings persistence
        await Task.Delay(500); // Simulate saving
        // Show success message or handle errors
    }
}